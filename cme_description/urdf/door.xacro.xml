<!-- Xacro XML snippet for a door macro -->

<robot xmlns:xacro="http://ros.org/wiki/xacro">
<xacro:macro name="door" params="id parent width height depth *frame_origin mass:=30 angle:=0 min_angle:=0 max_angle:=${pi/2}">
	<!-- Xacro Macro for a door with handle and joints.
	Args:
		id:
		parent:
		width:
		height:
		depth:
		*knob_pose:
		knob_length:
		num_joints:
		angle:
		minangle:
		maxangle:
	-->
	<!-- make the frame link, used for orientation at the _center_ of the door frame -->
	<link name="door_${id}_frame_link" />
	<joint name="door_${id}_frame_joint" type="fixed">
		<xacro:insert_block name="frame_origin"/>
		<parent link="${parent}"/>
		<child link="door_${id}_frame_link"/>
	</joint>
	<!-- make door link, parent=parent, location at hinges (offset width/height from parent) -->
	<link name="door_${id}_link">
		<visual>
			<origin xyz="${width/2} ${depth/2} ${height/2.0}" rpy="0 0 0" />
			<geometry>
				<box size="${width} ${depth} ${height}" />
			</geometry>
			<material name="brown"/>
		</visual>
		<collision>
			<origin xyz="${width/2} ${height/2} ${depth/2.0}" rpy="0 0 0" />
			<geometry>
				<box size="${width} ${height} ${depth}" />
			</geometry>
		</collision>
		<inertial>
			<mass value="${mass}" />
			<!-- Inertia calculated with moment of inertia tensors of a cuboid -->
			<inertia ixx="${0.083*mass*(width+height)}" ixy="0.0" ixz="0.0"
				 iyy="${0.083*mass*(depth+height)}" iyz="0.0" izz="${0.083*mass*(width+depth)}" />
		</inertial>
	</link>
	<joint name="door_${id}_joint" type="revolute">
		<origin xyz="-${width/2} 0 0" rpy="0 0 0" />
		<axis xyz="0 0 1" />
		<limit lower="${min_angle}" upper="${max_angle}" effort="1000" velocity="10" />
		<parent link="door_${id}_frame_link"/>
		<child link="door_${id}_link"/>
	</joint>

	<!-- door handle -->
	<!-- make door joint to open door, set start angle, set min/max angles -->
	<!--link name="door_${id}_handle">
		<visual>
			<origin xyz="0 0 0" rpy="0 0 0"/>
			<geometry>
				<box size="0.05 0.02 0.01"/>
			</geometry>
		</visual>
		<material name="white"/>
	</link-->
	<!--xacro:insert_block name="knob" /-->
</xacro:macro>
</robot>

<!-- link door-1 is for positioning the door to the center of the door frame
<link name="door-1" parent="wall-1" xyz="0 0 0" rpy="0 0 0" />
<xacro:door id="1" parent="wall-1" width="0.70" height="2.43" depth="0.05">
	<origin xyz="2.06 -3.05 0" rpy="0 0 0"/>
	<xacro:door_handle id="1" parent="door-1">
		<origin xyz="0 0.85 0.025" rpy="0 0 0" />
		<origin xyz="${x_loc + door_width/2 * direction_x} ${y_loc + width/2 * direction_y} 0" rpy="0 0 0" />
	</xacro:door_handle>
</xacro:door>
-->
